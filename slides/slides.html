<html>
	<head>
		<title>NEJS 2016 - JavaScript &amp; the WebAudio API</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
		<link rel="stylesheet" href="/slides/dist/app.css" />
	</head>
	<body>

		<div class="reveal">
			<div class="slides">

				<section data-transition="fade">
					<h1 class="title">JavaScript and<br />the WebAudio API</h1>
				</section>

				<section data-transition="fade">
					<h1 class="title--medium">Synthesizing, manipulating,
					<br />and controlling audio.</h1>
				</section>

				<section data-transition="fade">
					<h1 class="title">Audio = Math</h1>
				</section>

				<section data-transition="fade">
					<h1 class="title--medium">A synthesizer in the browser.</h1>
					<p>Synthesizer image</p>
				</section>

				<section data-transition="fade">
					<h1 class="title">AudioContext</h1>
					<pre class="fragment"><code class="js" data-trim>
// create web audio context
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
					</code></pre>
				</section>

				<section data-autoslide="1000" data-transition="fade">
					<h1 class="title--medium">Browser Support</h1>
					<div class="fragment">
						<ul class="support-list">
							<li class="support-list__item">
								<i class="fa fa-chrome" aria-hidden="true"></i>
								<i class="support-list__icon--supported fa fa-check" aria-hidden="true"></i>
							</li>
							<li class="support-list__item">
								<i class="fa fa-firefox" aria-hidden="true"></i>
								<i class="support-list__icon--supported fa fa-check" aria-hidden="true"></i>
							</li>
							<li class="support-list__item">
								<i class="fa fa-safari" aria-hidden="true"></i>
								<i class="support-list__icon--half-supported fa fa-check" aria-hidden="true"></i>
							</li>
							<li class="support-list__item">
								<i class="fa fa-edge" aria-hidden="true"></i>
								<i class="support-list__icon--supported fa fa-check" aria-hidden="true"></i>
							</li>
							<li class="support-list__item">
								<i class="fa fa-internet-explorer" aria-hidden="true"></i>
								<i class="support-list__icon--not-supported fa fa-times" aria-hidden="true"></i>
							</li>
						</ul>
					</div>
				</section>

				<section data-transition="fade">
					<h1 class="title--medium">Connecting Nodes</h1>
					<p>Guitar pedal image</p>
				</section>

				<section data-transition="fade">
					<h1 class="title--medium">Routing Graph</h1>
					<ul class="node-list">
						<li class="node-list__item">
							Source
						</li>
						<li class="node-list__arrow">
							<i class="fa fa-arrow-right" aria-hidden="true"></i>
						</li>
						<li class="node-list__item">
							Processing
						</li>
						<li class="node-list__arrow">
							<i class="fa fa-arrow-right" aria-hidden="true"></i>
						</li>
						<li class="node-list__item">
							Processing
						</li>
						<li class="node-list__arrow">
							<i class="fa fa-arrow-right" aria-hidden="true"></i>
						</li>
						<li class="node-list__item">
							Output
						</li>
					</ul>
				</section>

				<section data-transition="fade">
					<section data-transition="fade">
						<h1 class="title">Source Nodes</h1>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Media Element</h1>
						<pre><code class="js" data-trim>
// create web audio context
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// audio element as source
const source = document.querySelector('audio');

// create media element source nodes
const mediaElementSource = audioCtx.createMediaElementSource(sourceElement);

// connect source nodes to output
mediaElementSource.connect(audioCtx.destination);
						</code></pre>
						<a class="btn" href="/examples/sources/media-element.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Media Stream</h1>
						<pre><code class="js" data-trim>
// create web audio context
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// get user microphone input
navigator.mediaDevices.getUserMedia({
	audio: true,
}).then(stream => {
	// create media stream from mic input and connect to output
	mediaStream = audioCtx.createMediaStreamSource(stream);

	// connect media stream to output
	mediaStream.connect(audioCtx.destination);
});
						</code></pre>
						<a class="btn" href="/examples/sources/media-stream.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Audio Buffer</h1>
						<pre><code class="js" data-trim>
// create two second, stereo audio buffer and buffer source node
const buffer = audioCtx.createBuffer(2, audioCtx.sampleRate * 2.0, audioCtx.sampleRate);
const bufferSource = audioCtx.createBufferSource();

// get stereo channel data and fill each channel of the buffer with white noise
const channels = [buffer.getChannelData(0), buffer.getChannelData(1)];
channels.forEach(channel => {
	buffer.getChannelData(channel).forEach((val, key, arr) => {
		arr[key] = Math.random() * 2 - 1;
	});
});

// set the source buffer, connect buffer to output and start
bufferSource.buffer = buffer;
bufferSource.connect(audioCtx.destination);
bufferSource.start(0);
						</code></pre>
						<a class="btn" href="/examples/sources/audio-buffer.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Audio Buffer Decode</h1>
						<pre><code class="js" data-trim>
let bufferSource, buffer;

// fetch mp3
fetch('/assets/digitalsurgeons.mp3')
// fetch as array buffer
.then(response => response.arrayBuffer())
// decode audio data from array buffer
.then(arrayBuffer => audioCtx.decodeAudioData(arrayBuffer))
// create new buffer, connect to output and play
.then(decodedAudio => {
	bufferSource = audioCtx.createBufferSource();
	bufferSource.buffer = decodedAudio;
	bufferSource.connect(audioCtx.destination);
	bufferSource.start(0);
});
						</code></pre>
						<a class="btn" href="/examples/sources/audio-buffer-decode-audio.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Oscillator</h1>
						<pre><code class="js" data-trim>
// create web audio context
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// create sine wave oscillator, start and connect to output
const sine = audioCtx.createOscillator();
sine.type = 'sine'
sine.frequency.value = 880;
sine.connect(audioCtx.destination);
sine.start();

// create triangle wave oscillator, start and connect to output
const triangle = audioCtx.createOscillator();
triangle.type = 'triangle'
triangle.frequency.value = 440;
triangle.connect(audioCtx.destination);
triangle.start();
						</code></pre>
						<a class="btn" href="/examples/processing/biquad-filter.html" target="_blank">
							Wave Shapes
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
						<a class="btn" href="/examples/sources/oscillator.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>
				</section>

				<section data-transition="fade">
					<section data-transition="fade">
						<h1 class="title">Processing Nodes</h1>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Gain</h1>
						<pre><code class="js" data-trim>
// create oscillator
const oscillator = audioCtx.createOscillator();

// create gain
const gainNode = audioCtx.createGain();
gainNode.gain.value = .5;

// connect oscillator to gain, connect gain to output
oscillator.connect(gain);
gain.connect(audioCtx.destination);

oscillator.start();
						</code></pre>
						<a class="btn" href="/examples/processing/gain.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Delay</h1>
						<pre><code class="js" data-trim>
// create buffer source and set decoded audio
const bufferSource = audioCtx.createBufferSource();
bufferSource.buffer = decodedAudio;

// create delay node
const delay = audioCtx.createDelay(5.0);

// connect buffer source to output
bufferSource.connect(audioCtx.destination);

// connect buffer source to delay, connect delay to output
bufferSource.connect(delay);
delay.connect(audioCtx.destination);

bufferSource.start();
						</code></pre>
						<a class="btn" href="/examples/processing/delay.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Biquad Filter</h1>
						<pre><code class="js" data-trim>
// create media element source node from video element
const videoSource = audioCtx.createMediaElementSource(video);

// create biquad filter node
const biquadFilter = audioCtx.createBiquadFilter();

// set biquad filter values
biquadFilter.type = "bandpass";
biquadFilter.frequency.value = 500;
biquadFilter.Q.value = 5;

// connect video source to biquad filter, connect biquad filter to output
videoSource.connect(biquadFilter);
biquadFilter.connect(audioCtx.destination);
						</code></pre>
						<a class="btn" href="/examples/processing/biquad-filter.html" target="_blank">
							Filter Types
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
						<a class="btn" href="/examples/processing/biquad-filter.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Wave Shaper</h1>
						<pre><code class="js" data-trim>
// create wave shaper node
const waveShaper = audioCtx.createWaveShaper();
waveShaper.curve = makeDistortionCurve(50);
waveShaper.oversample = '4x';

// connect video source to biquad filter
// connect biquad filter to output
audioSource.connect(waveShaper);
waveShaper.connect(audioCtx.destination);

// distortion algorithm
function makeDistortionCurve(amount) {

}
						</code></pre>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Distortion Algorithm</h1>
						<pre><code class="js" data-trim>
function makeDistortionCurve(amount) {
	const k = typeof amount === 'number' ? amount : 50;
	const n_samples = 44100;
	const curve = new Float32Array(n_samples);
	const deg = Math.PI / 180;

	for (let i; i < n_samples; ++i) {
		let x = i * 2 / n_samples - 1;
		curve[i] = ( 3 + k ) * x * 20 * deg / (Math.PI + k * Math.abs(x));
	}

	return curve;
}
						</code></pre>
						<a class="btn" href="http://stackoverflow.com/questions/22312841/waveshaper-node-in-webaudio-how-to-emulate-distortion/22313408#22313408" target="_blank">
							StackOverflow
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
						<a class="btn" href="/examples/processing/wave-shaper.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>

					<section data-transition="fade">
						<h1 class="title--medium">Convolver</h1>
						<pre><code class="js" data-trim>
// create audio / impulse sources
const impulseBufferSource = audioCtx.createBufferSource();
const audioBufferSource = audioCtx.createBufferSource();
impulseBufferSource.buffer = decodedImpulse;
audioBufferSource.buffer = decodedAudio;

// create convolver node and set impulse buffer
const convolver = audioCtx.createConvolver();
convolver.buffer = decodedImpulse;

// connect audio source directly to output
audioSource.connect(audioCtx.destination);

// connect source to convolver, convolver to output
audioSource.connect(convolver);
convolver.connect(audioCtx.destination);
						</code></pre>
						<a class="btn" href="/assets/impulse.mp3" target="_blank">
							Hear impulse
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
						<a class="btn" href="/examples/processing/biquad-filter.html" target="_blank">
							View Example
							<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
						</a>
					</section>
				</section>

				<section data-transition="fade">
					<h1 class="title">WebAudio IRL</h1>
				</section>

				<section data-transition="fade">
					<h1 class="title">Game Design</h1>
					<a class="btn" href="/examples/demos/game-design.html" target="_blank">
						View Example
						<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
					</a>
				</section>

				<section data-transition="fade">
					<h1 class="title">Audio Visualization</h1>
					<a class="btn" href="/examples/demos/audio-visualization.html" target="_blank">
						View Example
						<i class="btn__icon fa fa-external-link" aria-hidden="true"></i>
					</a>
				</section>

				<section data-transition="fade">
					<h1 class="title">UI Design</h1>
				</section>

				<section data-transition="fade">
					<h1 class="title">Interactive Music</h1>
				</section>
			</div>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/headjs/0.96/head.min.js"></script>
		<script src="/slides/dist/app.js"></script>
	</body>
</html>
